<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>web testing</title>
    <link href="assets/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@200&display=swap" rel="stylesheet">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/bc871e0fef.js"></script>
</head>
<body>


<section class="container-fluid" id="customer-sec">
    <section class="row top-sec">
        <form id="dataForm">
            <div class="row " id="form-container">

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtCusId">Customer ID</label>
                        <input class="form-control" id="txtCusId" name="cusId" placeholder="Enter Customer ID"
                               type="text">
                    </div>
                </div>

                <div class="col-1"></div> <!--just for grid handling-->

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtCusName">Customer Name</label>
                        <input class="form-control" id="txtCusName" name="cusName" placeholder="Enter Customer Name"
                               type="text">
                    </div>
                </div>

                <div class="col-1"></div> <!--just for grid handling-->

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtCusAddress">Address</label>
                        <input class="form-control" id="txtCusAddress" name="cusAddress" placeholder="Enter Address"
                               type="text">
                    </div>
                </div>

                <div class="col-1"></div> <!--just for grid handling-->

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtCusContact">Contact</label>
                        <input class="form-control" id="txtCusContact" name="cusContact" placeholder="Enter Salary"
                               type="text">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-1"></div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnCustomerSearch" type="button">Search
                    </button>
                </div>
                <div class="col-5"></div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnCustomerSave" type="button">Save
                    </button>
                </div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnCustomerLoad" type="button">Load
                    </button>
                </div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnCustomerUpdate" type="button">Update
                    </button>
                </div>
                <div class="col-1">
                    <button class="btn btn-danger btnRefactor btn-sm" id="btnCustomerDelete" type="button">Delete
                    </button>
                </div>
                <div class="col-1"></div>
            </div>
        </form>

        <!--this is for background balancing-->
        <div class="row">
            <div style="height: 10px"></div>
        </div>
    </section>


    <section class="space-50"></section>
    <section class="main-container">
        <div class="space-1"></div>
        <div class="header-container">
            <label class="c-label-sp"></label>
            <label class="header">ID</label>
            <label class="header">Name</label>
            <label class="header">Address</label>
            <label class="header">Salary</label>
        </div>
        <div id="cus-records">

        </div>
    </section>
</section>


<!--product-->

<section class="container-fluid" id="product-sec">
    <section class=" row top-sec">
        <form id="item-dataForm">
            <div class="row " id="form-container-1">

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtItemId">Product ID</label>
                        <input class="form-control" id="txtItemId" name="productId" placeholder="Enter Product Id"
                               type="text">
                    </div>
                </div>

                <div class="col-1"></div> <!--just for grid handling-->

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtItemName">Product Name</label>
                        <input class="form-control" id="txtItemName" name="productName" placeholder="Enter Product Name"
                               type="text">
                    </div>
                </div>

                <div class="col-1"></div> <!--just for grid handling-->

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtQty">Qyt</label>
                        <input class="form-control" id="txtQty" name="Qyt" placeholder="Enter Qty" type="text">
                    </div>
                </div>

                <div class="col-1"></div> <!--just for grid handling-->

                <div class="col-2">
                    <div class="mb-3">
                        <label class="form-label" for="txtPrice">price</label>
                        <input class="form-control" id="txtPrice" name="Price" placeholder="Enter Price" type="text">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-1"></div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnItemSearch" type="button">Search
                    </button>
                </div>
                <div class="col-5"></div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnItemSave" type="button">Save
                    </button>
                </div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnItemLoad" type="button">Load
                    </button>
                </div>
                <div class="col-1">
                    <button class="btn btn-secondary btnRefactor btn-sm" id="btnItemUpdate" type="button">Update
                    </button>
                </div>
                <div class="col-1">
                    <button class="btn btn-danger btnRefactor btn-sm" id="btnItemDelete" type="button">Delete
                    </button>
                </div>
                <div class="col-1"></div>
            </div>
        </form>
        <div class="row">
            <div style="height: 10px"></div>
        </div>
    </section>


    <section class="space-50"></section>
    <section class="main-container">
        <div class="space-1"></div>
        <div class="header-container">
            <label class="c-label-sp"></label>
            <label class="header">ID</label>
            <label class="header">Name</label>
            <label class="header">Qty</label>
            <label class="header">Price</label>
        </div>
        <div id="pro-records">

        </div>
    </section>
</section>


<!--cart-->
<section class="container-fluid" id="cart-sec" style="display: none">

    <section class="row top-sec" id="c-cusDetails">
        <div class="row">
            <div style="height: 10px"></div>
        </div>
        <section class="row">
            <div class="col-2">
                <div class="btn-group">
                    <button aria-expanded="false" aria-haspopup="true" class="btn btn-secondary btn-sm dropdown-toggle"
                            data-toggle="dropdown" type="button">
                        Select Customer
                    </button>
                    <div class="dropdown-menu">
                        ...
                    </div>
                </div>
            </div>
            <div class="col-2">Customer ID :
                <label>C001</label>
            </div>
            <div class="col-3">Customer Name :
                <label>Menaka</label>
            </div>
        </section>
        <section class="row" id="c-proDetails">
            <div class="col-2">
                <div class="btn-group">
                    <button aria-expanded="false" aria-haspopup="true" class="btn btn-secondary btn-sm dropdown-toggle"
                            data-toggle="dropdown" type="button">
                        Select product
                    </button>
                    <div class="dropdown-menu">
                        ...
                    </div>
                </div>
            </div>
            <div class="col-2">Product</div>
            <div class="col-2">Price</div>
            <div class="col-2">Available Qty</div>
            <div class="col-2">Cost for Item</div>
            <div class="col-2">
                <div class="mb-3">
                    <input class="form-control" id="qtyForSale" name="qtyForSale" placeholder="Enter your Qty"
                           type="text">
                </div>
            </div>
        </section>
        <section class="row">
            <div class="col-11"></div>
            <div class="col-1">
                <button class="btn btn-secondary btnRefactor btn-sm" id="btnAddToCart" type="button">Add</button>
            </div>
        </section>

        <!--this is for background balancing-->
        <div class="row">
            <div style="height: 10px"></div>
        </div>
    </section>


    <section class="space-50"></section>
    <section class="main-container">
        <div class="space-1"></div>
        <div class="header-container">
            <label class="c-label-sp"></label>
            <label class="header">ID</label>
            <label class="header">Name</label>
            <label class="header">Address</label>
            <label class="header">Salary</label>
        </div>
        <div id="cart-records">

        </div>
    </section>
</section>
<!--end of the cart-->

<section id="console">
    <i aria-hidden="true" class="fas fa-users" id="customer-i">
        <div id="customer-l"><label>Customers</label></div>
    </i>
    <i class="fab fa-product-hunt" id="product-i">
        <div id="product-l"><label>Products</label></div>
    </i>
    <i class="fas fa-shopping-cart" id="cart-i">
        <div id="cart-l"><label>Your Cart</label></div>
    </i>
    <i class="fas fa-list" id="order-i">
        <div id="order-l"><label>All Orders</label></div>
    </i>
</section>
<section id="console-header">
    <label>Customer</label>
</section>


</body>

<script crossorigin="anonymous"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>

    document.getElementById("product-sec").style.display = "none";

    $("#customer-i").click(function () {
        $("#console-header > label").text("Customer");
        $("#console-header > label").css("left", "-20px");
        document.getElementById("product-sec").style.display = "none";
        document.getElementById("cart-sec").style.display = "none";
        document.getElementById("customer-sec").style.display = "block";
    });

    $("#product-i").click(function () {
        $("#console-header > label").text("Product");
        $("#console-header > label").css("left", "-10px");
        document.getElementById("customer-sec").style.display = "none";
        document.getElementById("cart-sec").style.display = "none";
        document.getElementById("product-sec").style.display = "block";
        loadAllProducts();
    });

    $("#cart-i").click(function () {
        $("#console-header > label").text("Cart");
        $("#console-header > label").css("left", "5px");
        document.getElementById("customer-sec").style.display = "none";
        document.getElementById("product-sec").style.display = "none";
        document.getElementById("cart-sec").style.display = "block";
    });


    /*Start of the customer section*/

    loadCustomers();

    $("#btnCustomerSave").click(function () {
        let serialize = $("#dataForm").serialize();
        $.ajax({
            url: "http://localhost:8080/BackEnd_Web2_exploded/customer",
            method: "POST",
            data: serialize,
            success: function (resp) {
                console.log(resp);
                loadCustomers();
            }
        });
    });

    $("#btnCustomerLoad").click(function () {
        loadCustomers();
    });

    $("#btnCustomerUpdate").click(function () {
        let customer = {
            id: $("#txtCusId").val(),
            name: $("#txtCusName").val(),
            address: $("#txtCusAddress").val(),
            contact: $("#txtCusContact").val()
        }
        $.ajax({
            url: "http://localhost:8080/BackEnd_Web2_exploded/customer",
            method: "PUT",
            contentType: "application/json",
            data: JSON.stringify(customer),
            success: function (resp) {
                if (resp.status == 200) {
                    swal("Successful!", resp.message, "success");
                    loadCustomers();
                } else {
                    swal("Unsuccessful!", resp.message, "error");
                }
            }
        });
    });

    $("#btnCustomerDelete").click(function () {
        swal({
            title: "Are you sure?",
            text: "Once deleted, It will be deleted permanently!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    $.ajax({
                        url: "http://localhost:8080/BackEnd_Web2_exploded/customer?cusId=" + $("#txtCusId").val(),
                        method: "DELETE",
                        success: function (resp) {
                            if (resp.status == 200) {
                                swal("Successful!", resp.message, "success");
                                loadCustomers();
                            } else {
                                swal("Unsuccessful!", resp.message, "error");
                            }
                        }
                    });
                }
            });
    });

    function loadCustomers() {
        $("#cus-records").empty();
        $.ajax({
            url: "http://localhost:8080/BackEnd_Web2_exploded/customer",
            method: "GET",
            success: function (resp) {
                let x = 1;
                for (const respElement of resp.data) {
                    let row = `<div class=\"content\"><label class="\c-label-sp\">${x++}</label><label class=\"c-label\">${respElement.id}</label><label class=\"c-label\">${respElement.name}</label><label class=\"c-label\">${respElement.address}</label><label class=\"c-label\">${respElement.contact}</label></div>`
                    $("#cus-records").append(row);
                }
                bindClickEventsForCus();
            }

        });
    }

    function bindClickEventsForCus() {
        $("#cus-records>div").click(function () {
            let id = $(this).children().eq(1).text();
            let name = $(this).children().eq(2).text();
            let address = $(this).children().eq(3).text();
            let contact = $(this).children().eq(4).text();

            $("#txtCusId").val(id);
            $("#txtCusName").val(name);
            $("#txtCusAddress").val(address);
            $("#txtCusContact").val(contact);
        });
    }

    /*End of the customer section*/


    /*Start of the product section*/

    $("#btnItemSave").click(function () {
        let product = {
            id: $("#txtItemId").val(),
            name: $("#txtItemName").val(),
            qty: $("#txtQty").val(),
            price: $("#txtPrice").val()
        }
        $.ajax({
            url: "http://localhost:8080/BackEnd_Web2_exploded/product",
            method: "POST",
            contentType: "application/json",
            data: JSON.stringify(product),
            success: function (resp) {
                if (resp.status == 200) {
                    swal("Successful!", resp.message, "success");
                    loadAllProducts();
                } else {
                    swal("Unsuccessful!", resp.message, "error");
                }
            }
        });
    });

    $("#btnItemLoad").click(function () {
        loadAllProducts();
    });

    function loadAllProducts() {
        $("#pro-records").empty();
    $.ajax({
        url:"http://localhost:8080/BackEnd_Web2_exploded/product",
        method:"GET",
        success:function (resp){
            let x = 1;
            for (const respElement of resp.data) {
                console.log("writing start");
                let row = `<div class=\"content\"><label class="\c-label-sp\">${x++}</label><label class=\"c-label\">${respElement.id}</label><label class=\"c-label\">${respElement.name}</label><label class=\"c-label\">${respElement.qty}</label><label class=\"c-label\">${respElement.price}</label></div>`
                $("#pro-records").append(row);
                bindClickEventsForProducts();
            }
        }
    });
    }

    $("#btnItemUpdate").click(function (){
        let product = {
            id: $("#txtItemId").val(),
            name: $("#txtItemName").val(),
            qty: $("#txtQty").val(),
            price: $("#txtPrice").val()
        }
        $.ajax({
            url:"http://localhost:8080/BackEnd_Web2_exploded/product",
            method:"PUT",
            contentType:"application/json",
            data:JSON.stringify(product),
            success:function (resp){
                if (resp.status == 200) {
                    swal("Successful!", resp.message, "success");
                    loadAllProducts();
                } else {
                    swal("Unsuccessful!", resp.message, "error");
                }
            }
        });
    });

    $("#btnItemDelete").click(function () {
        swal({
            title: "Are you sure?",
            text: "Once deleted, It will be deleted permanently!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    $.ajax({
                        url: "http://localhost:8080/BackEnd_Web2_exploded/product?id=" + $("#txtItemId").val(),
                        method: "DELETE",
                        success: function (resp) {
                            if (resp.status == 200) {
                                swal("Successful!", resp.message, "success");
                                loadAllProducts();
                            } else {
                                swal("Unsuccessful!", resp.message, "error");
                            }
                        }
                    });
                }
            });
    });

    function bindClickEventsForProducts() {
        $("#pro-records>div").click(function () {
            let id = $(this).children().eq(1).text();
            let name = $(this).children().eq(2).text();
            let address = $(this).children().eq(3).text();
            let contact = $(this).children().eq(4).text();

            $("#txtItemId").val(id);
            $("#txtItemName").val(name);
            $("#txtQty").val(address);
            $("#txtPrice").val(contact);
        });
    }
    /*End of the product section*/
</script>
</html>